<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Products</title>
    <script type="text/javascript" src="item.js"></script>
    <script type="text/javascript" src="common.js"></script>
    <link rel="stylesheet" href="shop.css">
</head>
<body id="body">

<script>addHeader();</script>

<div id="btnContainer">
    <button class="filterBtn active" onclick='updateList("all")'>all products</button>
    <button class="filterBtn" onclick='updateList("UCLan Hoodie")'>hoodies</button>
    <button class="filterBtn" onclick='updateList("UCLan Logo Jumper")'>jumpers</button>
    <button class="filterBtn" onclick='updateList("UCLan Logo Tshirt")'>t-shirts</button>
</div>

<div id="list">
</div>

<script>
    class Item {
        constructor(text) {
            this._type = text[0];
            this._color = text[1];
            this._description = text[2];
            this._value = text[3];
            this._image = text[4];
        }

        get type() {
            return this._type;
        }

        get color() {
            return this._color;
        }

        get description() {
            return this._description;
        }

        get value() {
            return this._value;
        }

        get image() {
            return this._image;
        }
    }

    let ALL_ITEMS = [];
    let lines = [];

    fetch("resources/items.csv").then(response => {
        console.log(response.status);
        response.text().then(response => {
            console.log(response); //Prints the response text on the console for debugging.
            lines = response.split('\n');
            console.log(lines.length);
            for (let i = 0; i < lines.length; ++i) {
                let line = lines[i].split(',');
                if (line[0].length > 0) {
                    ALL_ITEMS.push(new Item(line));
                }
            }
            createList();
        })
    });
    function createList() {
        let list = document.querySelector('#list');
        for (let i = 0; i < ALL_ITEMS.length; ++i) {
            let element = document.createElement("div");
            element.className = "itemCard" + ALL_ITEMS[i].type;
            element.id = "itemCard" + i;
            element.innerHTML =
                "<img src=\"resources/" + ALL_ITEMS[i].image + "\" alt=\"" + ALL_ITEMS[i].description + "\" width=\"100%\">\n" +
                "<h2>" + ALL_ITEMS[i].color + " " + ALL_ITEMS[i].type + "</h2>" +
                "<p>" + ALL_ITEMS[i].description + "</p>\n" +
                "<h3>" + ALL_ITEMS[i].value + "</h3>\n";
            list.appendChild(element);
        }
    }

    function updateList(filter) {
        for (let i = 0; i < ALL_ITEMS.length; ++i) {
            let item = document.getElementById("itemCard" + i);
            if ("all" === filter || "itemCard" + filter === item.className) {
                item.style.display = "block";
            } else {
                item.style.display = "none";
            }
        }
    }
</script>

<script>addFooter();</script>

</body>
</html>